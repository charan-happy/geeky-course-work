<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modern TODO App</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body
    class="min-h-screen bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 flex items-center justify-center p-4"
  >
    <div class="bg-white bg-opacity-90 rounded-2xl shadow-2xl p-8 w-full max-w-md">
      <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">
        üåà Modern TODO App
      </h1>
      <div class="flex mb-4">
        <input
          id="todoInput"
          type="text"
          placeholder="Add a new task..."
          class="flex-grow border rounded-l-md p-2 focus:outline-none focus:ring-2 focus:ring-purple-400"
        />
        <button
          onclick="addTodo()"
          class="bg-purple-500 hover:bg-purple-600 text-white px-4 rounded-r-md"
        >
          Add
        </button>
      </div>
      <ul id="todoList" class="space-y-2"></ul>
    </div>

    <script>
      const API = "/api/todos";

      async function fetchTodos() {
        const res = await fetch(API);
        const todos = await res.json();
        const list = document.getElementById("todoList");
        list.innerHTML = "";
        todos.forEach((t) => {
          const li = document.createElement("li");
          li.className =
            "flex justify-between items-center bg-gray-100 p-2 rounded-md shadow-sm";
          li.innerHTML = `
            <span class="${t.completed ? 'line-through text-gray-400' : ''}">${
            t.text
          }</span>
            <div class="space-x-2">
              <button onclick="toggleTodo('${t.id}')" class="text-green-600">‚úîÔ∏è</button>
              <button onclick="deleteTodo('${t.id}')" class="text-red-600">üóëÔ∏è</button>
            </div>
          `;
          list.appendChild(li);
        });
      }

      async function addTodo() {
        const text = document.getElementById("todoInput").value.trim();
        if (!text) return;
        await fetch(API, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text }),
        });
        document.getElementById("todoInput").value = "";
        fetchTodos();
      }

      async function toggleTodo(id) {
        await fetch(`${API}/${id}`, { method: "PUT" });
        fetchTodos();
      }

      async function deleteTodo(id) {
        await fetch(`${API}/${id}`, { method: "DELETE" });
        fetchTodos();
      }

      fetchTodos();
    </script>
  </body>
</html>

